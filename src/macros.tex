%%%%%%%%%%%% API Definition Macros %%%%%%%%%%%%

\newcommand*{\code}{\lstinline[breaklines]}
\newcommand{\apiref}[1]{\hyperref[api:#1]{\code{#1}}}
\newcommand{\apihref}[2]{\hyperref[api:#1]{#2}}
\newcommand{\apieventref}[1]{\code{#1}} % TODO
\newcommand{\apicapref}[1]{\code{#1}} % TODO
\newcommand{\apijvmtiref}[1]{\href{https://docs.oracle.com/en/java/javase/11/docs/specs/jvmti.html\##1}{\code{#1}}}
\newcommand{\jvmtihref}[2]{\href{https://docs.oracle.com/en/java/javase/11/docs/specs/jvmti.html\##1}{#2}}
\newcommand{\jnihref}[2]{\href{https://docs.oracle.com/en/java/javase/11/docs/specs/jni/functions.html\##1}{#2}}

\newenvironment{apidef}[1]{
   %\subsubsection*{\detokenize{#1}} \label{api:#1} *
   % TODO fix underline with an additional space after it
   \noindent \textbf{\detokenize{#1}} \label{api:#1}
   % TODO must remove spaces in label about
   \bigskip

   \newenvironment{apidesc}{
      \bigbreak
      \noindent \textbf{DESCRIPTION} \par
   }{
      \par \bigbreak
   }

   \newenvironment{apiphase}{
      \noindent \textbf{PHASES} \par
   }{
      \par \bigbreak
   }
   \newcommand{\apiphaseany}{This function may be called during any phase.}
   \newcommand{\apiphaseonload}{This function may only be called during the OnLoad phase.}
   \newcommand{\apiphaseonloadlive}{This function may only be called during the OnLoad or the live phase.}

   \newenvironment{apicap}{
      \noindent \textbf{CAPABILITIES} \par
   }{
      \par \bigbreak
   }
   \newcommand{\apicaprequired}{Required functionality.}

   \newenvironment{apiparam}{
      \noindent \textbf{PARAMETERS} \par
      \begin{itemize}[itemsep=0pt]
   }{
      \end{itemize}
      \par \bigbreak
   }
   \newcommand{\apiparamempty}{}
   \newcommand{\apiparamdef}[2]{\item[] \code{##1} ##2}

   \newenvironment{apireturn}{
      \noindent \textbf{RETURNS} \par
   }{
      \par \bigbreak
   }
   \newcommand{\apireturnempty}{}

   \newenvironment{apierror}{
      \noindent \textbf{ERROR CODES} \par
      This function returns either a universal error code or one of the following errors:
      \begin{itemize}[itemsep=0pt]
   }{
      \end{itemize}
      \par \bigbreak
   }
   \newcommand{\apierrorempty}{
      \noindent \textbf{ERROR CODES} \par
      This function returns a universal error code.
      \par \bigbreak
   }
   \newcommand{\apierrordef}[2]{\item[] \code{##1}: ##2}
}{
   \par \bigbreak
}
